<#include "../../inc/layout/page-default-top.html" />
  <!-- BEGIN PAGE BAR -->
    <div class="page-bar">
        <ul class="page-breadcrumb">
            <li>
                <span>企业管理</span>
                <i class="fa fa-circle"></i>
            </li>
            <li>
                <span>员工管理</span>
            </li>

        </ul>
    </div>
<!-- END PAGE BAR -->

<div class="container-fluid">
  <div class="row">
     <div class="col-md-12">
     <div class="tabbable-line boxless tabbable-reversed">
     		<ul class="nav nav-tabs">
                <#if (staffInfo.id) ?? >
                <li <#if tab=="staffinfo" > class="active" </#if> >
                    <a href="/crm/staff/staff_list_edit/${staffInfo.id}">员工信息</a>
                </li>
                <li <#if tab=="costfee"> class="active" </#if> >
                    <a href="/crm/staff/commission?staff_id=${staffInfo.id}&tab=costfee">员工提成</a>
                </li>
                </#if>
            </ul>
            <div class="tab-content">
            <div class="tab-pane active">
				<div class="portlet box green">
				              <div class="portlet-title">
				                  <div class="caption">
				                      <i class="fa fa-user"></i>
				                      	员工信息 
				                  </div>
				              </div>
				              
				              <div class="portlet-body form" style="display: block;">
				                  <!-- BEGIN FORM-->
				                  <form method="post" data-options="novalidate:false" id="ff" class="form-horizontal">
				                  	<input type="hidden" name="staff.id" value="${(staffInfo.id)!}" />	
				                    <input type="hidden" name="staffExtra.id" value="${(staffExtra.id)!}" />	
				                      <div class="form-body">
				                      
				                          <h3 class="form-section">基本信息</h3>
				                          <!--/row-->
				                          <div class="row">
				                              <div class="col-md-6">
				                                  <div class="form-group">
							                           <label class="col-md-3 control-label">在职情况</label>
							                           <div class="col-md-6">
							                           		<#if staffInfo.status ??>
							                           		        <label class="radio-inline">
																	<input class="" type="radio"  <#if staffInfo.status==0> checked="checked" </#if>  name="staff.status" value="${(0)!}" />在职
																	</label>
																	<label class="radio-inline">
																	<input class="" type="radio"  <#if staffInfo.status==-1> checked="checked" </#if> name="staff.status" value="${(-1)!}" />离职
															        </label>
															<#else>
																	<label class="radio-inline">
																	<input class="" type="radio"   checked="checked"  name="staff.status" value="${(0)!}" />在职
																	</label>
																	<label class="radio-inline">
																	<input class="" type="radio"   name="staff.status" value="${(-1)!}" />离职
															        </label>
															</#if>
							                           </div>
							                     ·	</div>
				                              </div>
				                              <!--/span-->
				                              <div class="col-md-6">
				                                 <div class="form-group">
							                           <label class="col-md-3 control-label">员工编号</label>
							                           <div class="col-md-6">
							                               <input type="text" id="sn" class="form-control input-medium" name="staff.sn" value="${(staffInfo.sn)!}" />
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                          </div>
				                          <!--/row-->
				                          <div class="row">
				                              <div class="col-md-6">
				                                   <div class="form-group">
							                           <label class="col-md-3 control-label">姓名</label>
							                           <div class="col-md-6">
															<input  type="text" id="name" class="form-control input-medium" name="staff.name"  value="${(staffInfo.name)!}" />
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                              <div class="col-md-6">
				                                   <div class="form-group">
							                           <label class="col-md-3 control-label">昵称</label>
							                           <div class="col-md-6">
															<input  type="text" class="form-control input-medium "  name="staff.nickname"  value="${(staffInfo.nickname)!}" />
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                          </div>
				                          <!--/row-->
				                          <div class="row">
				                              <div class="col-md-6">
				                                  <div class="form-group">
							                           <label class="col-md-3 control-label">员工账号</label>
							                           <div class="col-md-6">
															<select id="select2_uid"  name="staff.uid" class="form-control input-medium select2">
							           		    			<#if (staffInfo.uid)?? ><option value="${staffInfo.uid}">${(staffInfo.uid_name)!}</option></#if>
							           		    			</select>
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                              <div class="col-md-6">
				                                  <div class="form-group">
							                           <label class="col-md-3 control-label">性别</label>
							                           <div class="col-md-6">
							                           		 <#if (staffInfo.gender)??>
							                           		        <label class="radio-inline">
															 	 	<input class="" type="radio" <#if staffInfo.gender==1> checked="checked" </#if>  name="staff.gender" value="1" />男
															 	 	</label>
															 	 	<label class="radio-inline">
														        	<input class="" type="radio"  <#if staffInfo.gender==0> checked="checked" </#if>  name="staff.gender" value="0" />女
														            </label>
														     <#else>
														             <label class="radio-inline">
														       		 <input class="" type="radio"  checked="checked"   name="staff.gender" value="1" />男
														        	</label>
														        	 <label class="radio-inline">
														        	 <input class="" type="radio"  name="staff.gender" value="0" />女
														             </label>
														     </#if>
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                          </div>
				                          <!--/row-->
				                          <div class="row">
				                              <div class="col-md-6">
				                                 <div class="form-group">
							                           <label class="col-md-3 control-label">手机号</label>
							                           <div class="col-md-6">
															<input type="text" class="form-control input-medium" id="mobile" style="height:32px;" name="staff.mobile" value="${(staffInfo.mobile)!}" />
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                              <div class="col-md-6">
							                        <div class="form-group">
							                           <label class="col-md-3 control-label">生日</label>
							                           <div class="col-md-6">
															<input class="easyui-datebox" style="height:32px;" type="text" name="staff.birthday"  value="${(staffInfo.birthday)!}" />
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                          </div>
				                          <!--/row-->
				                          <div class="row">
				                              <div class="col-md-6">
				                                  <div class="form-group">
							                           <label class="col-md-3 control-label">电话</label>
							                           <div class="col-md-6">
															<input class="form-control input-medium" type="text" name="staff.tel"  value="${(staffInfo.tel)!}" />
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                              <div class="col-md-6">
				                                    <div class="form-group">
							                           <label class="col-md-3 control-label">邮箱</label>
							                           <div class="col-md-6">
															<input class="form-control input-medium" type="text" name="staff.email"  value="${(staffInfo.email)!}" />
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                          </div>
				                          <!--/row-->
				                          <div class="row">
				                              <div class="col-md-6">
				                                  <div class="form-group">
							                           <label class="col-md-3 control-label">QQ</label>
							                           <div class="col-md-6">
															<input  type="text" class="form-control input-medium "  name="staff.qq"  value="${(staffInfo.qq)!}" />
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                              <div class="col-md-6">
				                                  <div class="form-group">
							                           <label class="col-md-3 control-label">微信号</label>
							                           <div class="col-md-6">
															<input  type="text" class="form-control input-medium "  name="staff.wechat_no"  value="${(staffInfo.wechat_no)!}" />
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                          </div>
			                             <!--/row-->
				                          <div class="row">
				                              <div class="col-md-6">
				                                   <div class="form-group">
							                           <label class="col-md-3 control-label">所在部门</label>
							                           <div class="col-md-6">
							                           		<#if department_id==""><!-- 不是添加指定部门的人 -->
																<select id="select2"  name="staff.departments" multiple="multiple"  class="form-control input-medium select2">
																<#if (listDepartment)??>
																	<#list listDepartment as department>
								           		    					<option value="${(department.id)!}" selected="selected">${(department.name)!}</option>
								           		    				</#list>
								           		    			</#if>
							           		    				</select>
							           		    			<#else>
							           		    				<input type="hidden" name="staff.departments" value="${department_id}"/>
							           		    				<p class="form-control-static"> ${crmDepartment.name} </p>
							           		    			</#if>
							                           </div>
							                       </div> 
				                              </div>
				                              <!--/span-->
				                              <div class="col-md-6">
				                                    <div class="form-group">
							                           <label class="col-md-3 control-label">部门电话</label>
							                           <div class="col-md-6">
															<input class="form-control input-medium" type="text" name="staff.department_tel"  value="${(staffInfo.department_tel)!}" />
							                           </div>
							                       </div>  
				                              </div>
				                              <!--/span-->
				                          </div>
			                             <!--/row-->
				                          <div class="row">
				                          	<div class="col-md-6">
				                                   <div class="form-group">
							                           <label class="col-md-3 control-label">职位名称</label>
							                           <div class="col-md-6">  
								                           <input class="form-control input-xsmall easyui-combobox" name="staff.job_title_id" id="jobTitle" value="${(staffInfo.job_title_id)!}"
								                            data-options="valueField:'id',textField:'name',url:'/crm/staff/list_jobTitle',panelHeight:'auto'" 
								                            style="width:110px;height:35px;" />
							                            </div>
							                       </div> 
				                              </div>

				                              <!--/span-->
				                              <div class="col-md-6">
				                                   <div class="form-group">
							                           <label class="col-md-3 control-label">入职时间</label>
							                           <div class="col-md-6">
															<input class="easyui-datebox" style="height:32px;" type="text" name="staff.entry_time"  value="${(staffInfo.entry_time)!}" />
							                           </div>
							                       </div> 
				                              </div>
				                              <!--/span-->
				                          </div>
			                             <!--/row-->
				                          <div class="row">
				                          	  <div class="col-md-6">
				                                	<div class="form-group">
							                           <label class="col-md-3 control-label">员工类型</label>
							                           <div class="col-md-3">
							                           		<label class="radio-inline">
							                           			<input type="radio" name="staff.type" value="0"  <#if (staffInfo.type)?? > <#if staffInfo.type==0 > checked="checked" </#if> </#if> >临时员工
							                           		</label>
							                           		<label class="radio-inline">
							                           			<input type="radio" name="staff.type" value="1" <#if (staffInfo.type)?? > <#if staffInfo.type==1 > checked="checked" </#if> </#if> >正式员工
							                           		</label>
							                           </div>
							                           <div id="typeerror" class="col-md-1"></div>
							                       </div> 
				                              </div>
				                              
				                              <div class="col-md-6">
				                                	<div class="form-group">
							                           <label class="col-md-3 control-label">是否是工班组</label>
							                           <div class="col-md-3">
							                           		<label class="radio-inline">
							                           			<input type="radio" name="staff.worker_group" value="0"  <#if (staffInfo.worker_group)?? > <#if staffInfo.worker_group==0 > checked="checked" </#if>  <#else> checked="checked" </#if> >否
							                           		</label>
							                           		<label class="radio-inline">
							                           			<input type="radio" name="staff.worker_group" value="1" <#if (staffInfo.worker_group)?? > <#if staffInfo.worker_group==1 > checked="checked" </#if> </#if> >是
							                           		</label>
							                           </div>
							                       </div> 
				                              </div>
				                          </div>
				                          <!--/row-->
				                          <div class="row">
				                              <div class="col-md-6">
				                                <div class="form-group">
							                           <label class="col-md-3 control-label">备注</label>
							                           <div class="col-md-6">
															<textarea rows="3"  class="form-control input-medium" name="staff.comment">${(staffInfo.comment)!}</textarea>
							                           </div>
							                       </div> 
				                              </div>
				                          </div>
				                          
				                          <#if TF.has_perm("view_staff_all_info")>
				                          <h3 class="form-section">其他信息</h3>
				                          <!--/row-->
				                          <div class="row">
				                              <div class="col-md-6">
				                                 <div class="form-group">
						                           <label class="col-md-3 control-label">毕业学校</label>
						                           <div class="col-md-6">
														<input  type="text" class="form-control input-medium"  name="staffExtra.graduated_school"  value="${(staffExtra.graduated_school)!}" />
						                           </div>
						                       </div>
				                              </div>
				                              <div class="col-md-6">
				                                   <div class="form-group">
							                           <label class="col-md-3 control-label">专业</label>
							                           <div class="col-md-6">
															<input  type="text" class="form-control input-medium"  name="staffExtra.major"  value="${(staffExtra.major)!}" />
							                           </div>
							                       </div>
				                              </div>
				                          </div>
				                          <!--/row-->
				                          <div class="row">
				                              <div class="col-md-6">
				                                  <div class="form-group">
							                           <label class="col-md-3 control-label">学历</label>
							                           <div class="col-md-6">
															<input  type="text" class="form-control input-medium"  name="staffExtra.education"  value="${(staffExtra.education)!}" />
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                              <div class="col-md-6">
				                                   <div class="form-group">
							                           <label class="col-md-3 control-label">学位</label>
							                           <div class="col-md-6">
															<input  type="text" class="form-control input-medium"  name="staffExtra.degree"  value="${(staffExtra.degree)!}" />
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                          </div>
				                          <!--/row-->
				                          <div class="row">
				                              <div class="col-md-6">
				                                    <div class="form-group">
							                           <label class="col-md-3 control-label">籍贯</label>
							                           <div class="col-md-6">
															<input  type="text" class="form-control input-medium"  name="staffExtra.hometown"  value="${(staffExtra.hometown)!}" />
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                              <div class="col-md-6">
				                                     <div class="form-group">
							                           <label class="col-md-3 control-label">户口所在地</label>
							                           <div class="col-md-6">
															<textarea  class="form-control input-medium " rows="3"  name="staffExtra.hometown_addr">${(staffExtra.hometown_addr)!}</textarea>
							                           </div>
							                       </div>  
				                              </div>
				                              <!--/span-->
				                          </div>
				                          <!--/row-->
				                           <div class="row">
				                              <div class="col-md-6">
				                                    <div class="form-group">
							                           <label class="col-md-3 control-label">户口性质</label>
							                           <div class="col-md-6">
															<input  type="text" class="form-control input-medium"  name="staffExtra.hometown_type"  value="${(staffExtra.hometown_type)!}" />
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                              <div class="col-md-6">
				                                      <div class="form-group">
								                           <label class="col-md-3 control-label">身份证号</label>
								                           <div class="col-md-6">
																<input  type="text" class="form-control input-medium"  name="staffExtra.id_no"  value="${(staffExtra.id_no)!}" />
								                           </div>
								                       </div>  
				                              </div>
				                              <!--/span-->
				                          </div>
				                          <!--/row-->
				                           <div class="row">
				                              <div class="col-md-6">
				                                    <div class="form-group">
							                           <label class="col-md-3 control-label">现居地址</label>
							                           <div class="col-md-6">
															<textarea  class="form-control input-medium" rows="3" name="staffExtra.address">${(staffExtra.address)!}</textarea>
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                              <div class="col-md-6">
				                                     <div class="form-group">
							                           <label class="col-md-3 control-label">政治面貌</label>
							                           <div class="col-md-6">
															<input  type="text" class="form-control input-medium"  name="staffExtra.landscape"  value="${(staffExtra.landscape)!}" />
							                           </div>
							                       </div>  
				                              </div>
				                              <!--/span-->
				                          </div>
				                          <!--/row-->
				                           <div class="row">
				                              <div class="col-md-6">
				                                    <div class="form-group">
							                           <label class="col-md-3 control-label">婚姻状况</label>
							                           <div class="col-md-6">
							                           		<#if staffExtra.marital_status ??>
							                           		        <label class="radio-inline">
																	<input class="" type="radio" <#if staffExtra.marital_status==0> checked="checked" </#if>  name="staffExtra.marital_status" value="${(0)!}" />未婚
																	</label>
																	<label class="radio-inline">
																	<input class="" type="radio" <#if staffExtra.marital_status==1> checked="checked" </#if>  name="staffExtra.marital_status" value="${(1)!}" />已婚
															        </label>
															<#else>
																	<label class="radio-inline">
																	<input class="" type="radio" checked="checked"  name="staffExtra.marital_status" value="${(0)!}" />未婚
																	</label>
																	<label class="radio-inline">
																	<input class="" type="radio"   name="staffExtra.marital_status" value="${(1)!}" />已婚
															        </label>
															</#if>
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                              <div class="col-md-6">
				                                     <div class="form-group">
							                           <label class="col-md-3 control-label">健康状况</label>
							                           <div class="col-md-6">
															<input  type="text" class="form-control input-medium"  name="staffExtra.health"  value="${(staffExtra.health)!}" />
							                           </div>
							                       </div> 
				                              </div>
				                              <!--/span-->
				                          </div>
				                          <!--/row-->
				                           <div class="row">
				                              <div class="col-md-6">
				                                    <div class="form-group">
							                           <label class="col-md-3 control-label">银行卡开户行</label>
							                           <div class="col-md-6">
															<input  type="text" class="form-control input-medium"  name="staffExtra.bank_card_name"  value="${(staffExtra.bank_card_name)!}" />
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                              <div class="col-md-6">
				                                      <div class="form-group">
								                           <label class="col-md-3 control-label">银行卡号</label>
								                           <div class="col-md-6">
																<input  type="text" class="form-control input-medium"  name="staffExtra.bank_card_no"  value="${(staffExtra.bank_card_no)!}" />
								                           </div>
								                       </div> 
				                              </div>
				                              <!--/span-->
				                          </div>
				                          <!--/row-->
				                           <div class="row">
				                              <div class="col-md-6">
				                                     <div class="form-group">
							                           <label class="col-md-3 control-label">紧急联系人</label>
							                           <div class="col-md-6">
															<input  type="text" class="form-control input-medium"  name="staffExtra.contact"  value="${(staffExtra.contact)!}" />
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                              <div class="col-md-6">
				                                      <div class="form-group">
							                           <label class="col-md-3 control-label">和紧急联系人关系</label>
							                           <div class="col-md-6">
															<input  type="text" class="form-control input-medium"  name="staffExtra.contact_relation"  value="${(staffExtra.contact_relation)!}" />
							                           </div>
							                       </div>  
				                              </div>
				                              <!--/span-->
				                          </div>
				                          <!--/row-->
				                           <div class="row">
				                              <div class="col-md-6">
				                                     <div class="form-group">
							                           <label class="col-md-3 control-label">紧急联系人电话</label>
							                           <div class="col-md-6">
															<input  type="text" class="form-control input-medium"  name="staffExtra.contact_relation_phone"  value="${(staffExtra.contact_relation_phone)!}" />
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                              <div class="col-md-6">
				                                     <div class="form-group">
							                           <label class="col-md-3 control-label">获得奖项</label>
							                           <div class="col-md-6">
															<input  type="text" class="form-control input-medium"  name="staffExtra.awards"  value="${(staffExtra.awards)!}" />
							                           </div>
							                       </div>  
				                              </div>
				                              <!--/span-->
				                          </div>
				                          <!--/row-->
				                           <div class="row">
				                              <div class="col-md-6">
				                                    <div class="form-group">
							                           <label class="col-md-3 control-label">获得证书</label>
							                           <div class="col-md-6">
															<input  type="text" class="form-control input-medium"  name="staffExtra.certificate"  value="${(staffExtra.certificate)!}" />
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                              <div class="col-md-6">
				                                     <div class="form-group">
							                           <label class="col-md-3 control-label">福利</label>
							                           <div class="col-md-6">
															<input  type="text" class="form-control input-medium"  name="staffExtra.welfare"  value="${(staffExtra.welfare)!}" />
							                           </div>
							                       </div>  
				                              </div>
				                              <!--/span-->
				                          </div>
				                          <!--/row-->
				                           <div class="row">
				                              <div class="col-md-6">
				                                  <div class="form-group">
							                           <label class="col-md-3 control-label">社保情况</label>
							                           <div class="col-md-6">
															<input  type="text" class="form-control input-medium"  name="staffExtra.social_security"  value="${(staffExtra.social_security)!}" />
							                           </div>
							                       </div>
				                              </div>
				                              <!--/span-->
				                              <div class="col-md-6">
				                                    <div class="form-group">
							                           <label class="col-md-3 control-label">转正时间</label>
							                           <div class="col-md-6">
															<input class="easyui-datebox" style="height:32px;" type="text" name="staffExtra.regular_time"  value="${(staffExtra.regular_time)!}" />
							                           </div>
							                       </div>   
				                              </div>
				                              <!--/span-->
				                          </div>
				                          <!--/row-->
				                           <div class="row">
				                              <div class="col-md-6">
				                                    <div class="form-group">
							                           <label class="col-md-3 control-label">离职时间</label>
							                           <div class="col-md-6">
															<input class="easyui-datebox" style="height:32px;" type="text" name="staffExtra.leave_time"  value="${(staffExtra.leave_time)!}" />
							                           </div>
							                       </div> 
				                              </div>
				                          </div>
				                          <!--/row-->
				                      </#if>
				                      </div>
				                      
				                      <#if TF.has_perm("view_staff_all_info")>
				                      <div class="form-actions">
				                          <div class="row">
				                              <div class="col-md-12">
				                                  <div class="row">
				                                      <div class="col-md-offset-5 col-md-7">
				                                      	  <button type="button" id="save" onclick="save_data('history');" class="btn green">保存并返回</button>
                               							  <button type="button" id="save_continue" onclick="save_data('continue');" class="btn yellow">保存并继续</button>
				                                          <button type="button" onclick="returnlist()" class="btn green">返回列表</button>
				                                      </div>
				                                  </div>
				                              </div>
				                          </div>
				                      </div>
				                      </#if>
				                      
				                  </form>
				                  <!-- END FORM-->
				        </div>
				   </div>
			   </div>
			   </div>
			 </div>  
   			</div><!-- end of col-->
	</div><!-- end of row-->
</div><!-- end of container-->


<style type="text/css"></style>

<script src="${BASE_PATH}assets/global/plugins/layer/layer.js" type="text/javascript"></script>
<script type="text/javascript">
function returnlist(){
	window.location.href='/crm/staff';
}


function save_data(value) {
	var sn = $("#sn").val();//编号
	var name = $("#name").val();//姓名
	var mobile=$('#mobile').val();//手机
	
	var type=$('input[name="staff.type"]:checked').val();
	
	if(!sn){
		layer.tips('请输入员工编号', '#sn',{
			tips:[2,'#f7ca18']
		});
		$('#sn').focus();
		return;
	}
	
	if(!name){
		layer.tips('请输入员工姓名', '#name',{
			tips:[2,'#f7ca18']
		});
		$('#name').focus();
		return;
	}
	
	if(!mobile){
		layer.tips('请输入手机号', '#mobile',{
			tips:[2,'#f7ca18']
		});
		$('#mobile').focus();
		return;
	}
	
	if(!type){
		layer.tips('请选择员工类型', '#typeerror',{
			tips:[2,'#f7ca18']
		});
		return;
	}
	
	$.ajax({
		type:"POST",
		url:'/crm/staff/staff_list_update',
		data:$('#ff').serialize(),
		beforeSend:function(){
			if(value=='history'){
				$("#save").text("提交中...");
				$("#save").attr("disabled",true);
			}
			else{
				$('#save_continue').text('提交中');
				$('#save_continue').attr("disabled",true);
			}
		},
		dataType:"json",
		success:function(data){
			if(data.status=="SUCCESS"){
				$.messager.alert('',data.message,"info",function(r){
					//window.close();//关闭当前页
					//self.location=document.referrer;//返回上一页并刷新
					if(value=='history'){
						<#if department_id=="">
							window.location.href='/crm/staff';
						<#else>
							window.location.href='/crm/staff/${department_id}';
						</#if>
					}
					else{
						window.location.reload();
					}
				});
			}else{
				$.messager.alert('',data.message,"error",function(r){
					if(value=='history'){
						$("#save").text("保存并返回");
						$("#save").attr("disabled",false);
					}
					else{
						$('#save_continue').text('保存并继续');
						$('#save_continue').attr("disabled",false);
					}
				});
			}
		},
		error:function(data){
			if(value=='history'){
				$("#save").text("保存并返回");
				$("#save").attr("disabled",false);
			}
			else{
				$('#save_continue').text('保存并继续');
				$('#save_continue').attr("disabled",false);
			}
			
			$.messager.alert('提示信息','系统错误，请联系管理员',"error");
		}
	});
}

/* function save_data(){
	form_data_save("#ff", "/crm/staff/staff_list_update", function(data){
		$("#list").datagrid("reload");
	}, {window_close:true,window_reload:true});
} */
	
	//select2方法
$(function(){
		$('#select2').select2({
            allowClear: true,
            //theme:"default",
            language: "zh-CN",
            minimumInputLength: 0,//2
            placeholder:"请选择部门",
            ajax:{
            	url:"/crm/staff/json_staff_department_select2",
			    data: function (params) {
			    	//console.log(params);
			      var query = {
			        q: params.term,
			        page: params.page,
			        rows: 20,
			        id: ${id!"0"}
			      };
			      // Query paramters will be ?search=[term]&page=[page]
			      return query;
			    },
            	delay: 500,
            	//dataType: 'json',
            	cache:true,
             	processResults: function (data, params) {//when use ajax data this method is required!!!
			      return {results:data};
			    },     
            },
            //data:person_info,
            templateResult: function (data) {
            	//console.log(data.name);
            		return data.text;
			  }  
        });
        
        	     //select2绑定事件
	        $('#select2').on('select2:select', function (e) {
				  //console.log(e.currentTarget.value);
				  //var selected_name = $('#select2 :selected').text();
				  //console.log(selected_name);
				  //$("#sourceStaff").val(selected_name);
				   var url = '/crm/staff/list_jobTitle?id=' + e.currentTarget.value;
	     		  $('#jobTitle').combobox('setValue' , '');//每次改变部门都将下级菜单清空
	     		  $('#jobTitle').combobox('reload', url);
					 
			});
			
			//select2选择账号
			$('#select2_uid').select2({
            allowClear: true,
            //theme:"default",
            language: "zh-CN",
            minimumInputLength: 0,//2
            placeholder:"请选择员工账号",
            ajax:{
            	url:"/crm/staff/json_uid_select2",
			    data: function (params) {
			    	//console.log(params);
			      var query = {
			        q: params.term,
			        page: params.page,
			        rows: 20,
			        id: ${uid!"0"}
			      };
			      // Query paramters will be ?search=[term]&page=[page]
			      return query;
			    },
            	delay: 500,
            	//dataType: 'json',
            	cache:true,
             	processResults: function (data, params) {//when use ajax data this method is required!!!
			      return {results:data};
			    },     
            },
            //data:person_info,
            templateResult: function (data) {
            	//console.log(data.name);
            		return data.text;
			  }    
        });
			
	});
	

</script>
<#include "../../inc/layout/page-default-bottom.html" />